<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="Common functions used for generation a MAC (message authentication code)." />
<meta name="DC.relation" scheme="URI" content="GUID-E5AC2B5B-4DA1-4D7D-A714-901692577E30.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="common-functions-used-for-generation-a-mac-message-authentication-code" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<title>Common functions used for generation a MAC (message authentication code).</title>
<meta name="Microsoft.Help.Id" content="GUID-2085FE66-A762-4CC0-B054-7F98E8AF999A" />
<meta name="Microsoft.Help.TocParent" content="GUID-2085FE66-A762-4CC0-B054-7F98E8AF999A-GUID-E5AC2B5B-4DA1-4D7D-A714-901692577E30" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLAB Harmony PIC32CX-BZ System Services Reference 4 10/2023" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
         
         function copyContent(content, button) {
         
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                     button.textContent = "Copy";
                     button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
               console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
         }
         
         function cpy(id, button) {
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            
            copyContent(content, button);
         }
         
         document.addEventListener("DOMContentLoaded", function(event) {
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.style.position = "relative";
               var copy = document.createElement("button");
               copy.textContent = "Copy";
               copy.setAttribute("class", "copy-code");
               
               var content = elem.textContent;
               
               copy.addEventListener("click", function(){
                  copyContent(content, copy);
               });
               
               elem.addEventListener("mouseenter", function(evt){
                  elem.prepend(copy);
               });
            });
            
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.addEventListener("mouseleave", function(evt){
                  document.querySelector(".copy-code").remove();
               });
            });
         });
         
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /></head>
<body>
<div class="nested0" aria-labelledby="ariaid-title1" id="common-functions-used-for-generation-a-mac-message-authentication-code"><h1 class="title topictitle1" id="ariaid-title1" style="">Common functions used for generation a MAC (message authentication code).</h1><div class="body"></div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-E5AC2B5B-4DA1-4D7D-A714-901692577E30.html" title="Enter a short description of your topic here (optional).">SX_symcrypt_API</a></div>
</div>
</div></div>
<div class="topic nested0" aria-labelledby="ariaid-title2" id="mac-api-file-macro"><h1 class="title topictitle1" id="ariaid-title2" style="">MAC_API_FILE Macro</h1><div class="body"></div>
<div class="topic nested1" aria-labelledby="ariaid-title3" id="c"><h2 class="title topictitle2" id="ariaid-title3" style="">C</h2><div class="body"><pre class="pre codeblock c"><span class="hl-directive">#define</span> <span class="hl-defines">MAC_API_FILE</span>
</pre><p class="p">@file
@copyright Copyright (c) 2020 Silex Insight. All Rights reserved.</p>
</div>
</div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title4" id="feeds-data-to-be-used-for-mac-generation"><h1 class="title topictitle1" id="ariaid-title4" style="">Feeds data to be used for MAC generation.</h1><div class="body"></div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title5" id="sx-mac-feed-macro"><h1 class="title topictitle1" id="ariaid-title5" style="">SX_MAC_FEED Macro</h1><div class="body"></div>
<div class="topic nested1" aria-labelledby="ariaid-title6" id="c-1"><h2 class="title topictitle2" id="ariaid-title6" style="">C</h2><div class="body"><pre class="pre codeblock c"><strong class="hl-keyword">typedef</strong> <strong class="hl-keyword">int</strong> (FUNC_SX_MAC_FEED)(<strong class="hl-keyword">struct</strong> sxmac c, <strong class="hl-keyword">const</strong> <strong class="hl-keyword">char</strong> datain, size_t sz);
<span class="hl-directive">#define</span> <span class="hl-defines">SX_MAC_FEED</span> ((FUNC_SX_MAC_FEED)((uint32_t )(API_TABLE_BASE_ADDRESS + ATO_SX_MAC_FEED)))
</pre><p class="p">The function will return immediately.</p>
<p class="p">In order to start the operation SX_MAC_GENERATE() must be called.</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title7" id="parameters"><h2 class="title topictitle2" id="ariaid-title7" style="">Parameters</h2><div class="body"><p class="p"><span class="xref"></span> c MAC operation context</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title8" id="parameters-1"><h2 class="title topictitle2" id="ariaid-title8" style="">Parameters</h2><div class="body"><p class="p"><span class="xref"></span> datain data to be processed, with size \p sz</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title9" id="parameters-2"><h2 class="title topictitle2" id="ariaid-title9" style="">Parameters</h2><div class="body"><p class="p"><span class="xref"></span> sz size, in bytes, of data to be processed  @return ::SX_OK  @return ::SX_ERR_UNITIALIZED_OBJ  @return ::SX_ERR_TOO_BIG  @return ::SX_ERR_FEED_COUNT_EXCEEDED  | Param | Description |
|:----- |:----------- |</p>
<p class="p">| @pre | sx_mac_create_() function must be called first| @remark | this function can be called even if data size, \p sz, is 0. |
| @remark | this function can be called multiple times to feed multiple chunks  scattered in memory.</p>
</div>
</div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title10" id="starts-mac-generation-operation"><h1 class="title topictitle1" id="ariaid-title10" style="">Starts MAC generation operation.</h1><div class="body"></div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title11" id="sx-mac-generate-macro"><h1 class="title topictitle1" id="ariaid-title11" style="">SX_MAC_GENERATE Macro</h1><div class="body"></div>
<div class="topic nested1" aria-labelledby="ariaid-title12" id="c-2"><h2 class="title topictitle2" id="ariaid-title12" style="">C</h2><div class="body"><pre class="pre codeblock c"><strong class="hl-keyword">typedef</strong> <strong class="hl-keyword">int</strong> (FUNC_SX_MAC_GENERATE)(<strong class="hl-keyword">struct</strong> sxmac c, <strong class="hl-keyword">char</strong> mac);
<span class="hl-directive">#define</span> <span class="hl-defines">SX_MAC_GENERATE</span> ((FUNC_SX_MAC_GENERATE)((uint32_t )(API_TABLE_BASE_ADDRESS + ATO_SX_MAC_GENERATE)))
</pre><p class="p">This function is used to start MAC generation.
The function will return immediately.</p>
<p class="p">The result will be transfered only after the operation is successfully
completed. The user shall check operation status with SX_MAC_STATUS()
or SX_MAC_WAIT().</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title13" id="parameters-3"><h2 class="title topictitle2" id="ariaid-title13" style="">Parameters</h2><div class="body"><p class="p"><span class="xref"></span> c MAC operation context</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title14" id="parameters-4"><h2 class="title topictitle2" id="ariaid-title14" style="">Parameters</h2><div class="body"><p class="p"><span class="xref"></span> mac generated MAC  @return ::SX_OK  @return ::SX_ERR_UNITIALIZED_OBJ  @return ::SX_ERR_TOO_SMALL  | Param | Description |
|:----- |:----------- |</p>
<p class="p">| @pre | SX_MAC_FEED() function must be called first| @remark | if used with context saving(last chunk), the fed data size for  the last chunk can not be 0</p>
</div>
</div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title15" id="resumes-mac-operation-in-context-saving"><h1 class="title topictitle1" id="ariaid-title15" style="">Resumes MAC operation in context-saving.</h1><div class="body"></div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title16" id="sx-mac-resume-state-macro"><h1 class="title topictitle1" id="ariaid-title16" style="">SX_MAC_RESUME_STATE Macro</h1><div class="body"></div>
<div class="topic nested1" aria-labelledby="ariaid-title17" id="c-3"><h2 class="title topictitle2" id="ariaid-title17" style="">C</h2><div class="body"><pre class="pre codeblock c"><strong class="hl-keyword">typedef</strong> <strong class="hl-keyword">int</strong> (FUNC_SX_MAC_RESUME_STATE)(<strong class="hl-keyword">struct</strong> sxmac c);
<span class="hl-directive">#define</span> <span class="hl-defines">SX_MAC_RESUME_STATE</span> ((FUNC_SX_MAC_RESUME_STATE)((uint32_t )(API_TABLE_BASE_ADDRESS + ATO_SX_MAC_RESUME_STATE)))
</pre><p class="p">This function shall be called when using context-saving to load the state
that was previously saved by SX_MAC_SAVE_STATE() in the sxmac operation
context \p c. It must be called with the same sxmac operation context \p c
that was used with SX_MAC_SAVE_STATE(). It will reserve all hardware
resources required to run the partial MAC operation.</p>
<p class="p">After successful execution of this function, the context \p c can be passed
to any of the block cipher functions, except the sx_mac_create_()
functions.</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title18" id="parameters-5"><h2 class="title topictitle2" id="ariaid-title18" style="">Parameters</h2><div class="body"><p class="p"><span class="xref"></span> c block cipher operation context  @return ::SX_OK  @return ::SX_ERR_UNITIALIZED_OBJ  @return ::SX_ERR_CONTEXT_SAVING_NOT_SUPPORTED  @return ::SX_ERR_INVALID_KEYREF  @return ::SX_ERR_INVALID_KEY_SZ  @return ::SX_ERR_INCOMPATIBLE_HW  @return ::SX_ERR_RETRY  | Param | Description |
|:----- |:----------- |</p>
<p class="p">| @pre | sx_mac_create_() and SX_MAC_SAVE_STATE() functions  must be called before, for first part of the message. |
| @pre | must be called for each part of the message(besides first), before  sx_mac_crypt() or SX_MAC_SAVE_STATE().| @remark | the user must not change the key until all parts of the message to  be encrypted/decrypted are processed.</p>
</div>
</div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title19" id="starts-a-partial-mac-operation"><h1 class="title topictitle1" id="ariaid-title19" style="">Starts a partial MAC operation.</h1><div class="body"></div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title20" id="sx-mac-save-state-macro"><h1 class="title topictitle1" id="ariaid-title20" style="">SX_MAC_SAVE_STATE Macro</h1><div class="body"></div>
<div class="topic nested1" aria-labelledby="ariaid-title21" id="c-4"><h2 class="title topictitle2" id="ariaid-title21" style="">C</h2><div class="body"><pre class="pre codeblock c"><strong class="hl-keyword">typedef</strong> <strong class="hl-keyword">int</strong> (FUNC_SX_MAC_SAVE_STATE)(<strong class="hl-keyword">struct</strong> sxmac c);
<span class="hl-directive">#define</span> <span class="hl-defines">SX_MAC_SAVE_STATE</span> ((FUNC_SX_MAC_SAVE_STATE)((uint32_t )(API_TABLE_BASE_ADDRESS + ATO_SX_MAC_SAVE_STATE)))
</pre><p class="p">This function is used to start a partial MAC operation on data fed using
SX_MAC_FEED().
The function will return immediately.</p>
<p class="p">The partial result will be transfered only after the operation is
successfully completed. The user shall check operation status with
SX_MAC_STATUS() or SX_MAC_WAIT().</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title22" id="parameters-6"><h2 class="title topictitle2" id="ariaid-title22" style="">Parameters</h2><div class="body"><p class="p"><span class="xref"></span> c block cipher operation context  @return ::SX_OK  @return ::SX_ERR_UNITIALIZED_OBJ  @return ::SX_ERR_CONTEXT_SAVING_NOT_SUPPORTED  @return ::SX_ERR_TOO_SMALL  @return ::SX_ERR_WRONG_SIZE_GRANULARITY  | Param | Description |
|:----- |:----------- |</p>
<p class="p">| @pre | sx_mac_crypt() should be called first.| @remark | the user must not change the key until all parts of the message to  be encrypted/decrypted are processed.</p>
</div>
</div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title23" id="waits-until-the-given-mac-generation-operation-has-finished"><h1 class="title topictitle1" id="ariaid-title23" style="">Waits until the given MAC generation operation has finished</h1><div class="body"></div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title24" id="sx-mac-wait-macro"><h1 class="title topictitle1" id="ariaid-title24" style="">SX_MAC_WAIT Macro</h1><div class="body"></div>
<div class="topic nested1" aria-labelledby="ariaid-title25" id="c-5"><h2 class="title topictitle2" id="ariaid-title25" style="">C</h2><div class="body"><pre class="pre codeblock c"><strong class="hl-keyword">typedef</strong> <strong class="hl-keyword">int</strong> (FUNC_SX_MAC_WAIT)(<strong class="hl-keyword">struct</strong> sxmac c);
<span class="hl-directive">#define</span> <span class="hl-defines">SX_MAC_WAIT</span> ((FUNC_SX_MAC_WAIT)((uint32_t )(API_TABLE_BASE_ADDRESS + ATO_SX_MAC_WAIT)))
</pre><p class="p">This function returns when the MAC generation operation was successfully
completed, or when an error has occurred that caused the operation to
terminate. The return value of this function is the operation status.</p>
<p class="p">After this call, all resources have been released and \p c cannot be used
again unless sx_mac_create_() is used.</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title26" id="parameters-7"><h2 class="title topictitle2" id="ariaid-title26" style="">Parameters</h2><div class="body"><p class="p"><span class="xref"></span> c MAC generation operation context  @return ::SX_OK  @return ::SX_ERR_UNITIALIZED_OBJ  @return ::SX_ERR_DMA_FAILED  @return ::SX_ERR_INVALID_TAG   @see SX_MAC_STATUS().  | Param | Description |
|:----- |:----------- |</p>
<p class="p">| @remark | this function is blocking until operation finishes.</p>
</div>
</div>
</div>
<div class="topic nested0" aria-labelledby="ariaid-title27" id="returns-the-mac-generation-operation-status"><h1 class="title topictitle1" id="ariaid-title27" style="">Returns the MAC generation operation status.</h1><div class="body"><p class="p">If the operation is still ongoing, return ::SX_ERR_HW_PROCESSING.
In that case, the user can retry later.</p>
<p class="p">When this function returns with a code different than ::SX_ERR_HW_PROCESSING,
the MAC generation operation has ended and all resources used by MAC generation
operation context \p c have been released. In this case, \p c cannot be used
for a new operation until one of the sx_mac_create_() functions is
called again.</p>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title28" id="parameters-8"><h2 class="title topictitle2" id="ariaid-title28" style="">Parameters</h2><div class="body"><p class="p"><span class="xref"></span> c MAC operation context  @return ::SX_OK  @return ::SX_ERR_UNITIALIZED_OBJ  @return ::SX_ERR_HW_PROCESSING  @return ::SX_ERR_DMA_FAILED  @return ::SX_ERR_INVALID_TAG  | Param | Description |
|:----- |:----------- |</p>
<p class="p">| @pre | SX_MAC_FEED() and SX_MAC_GENERATE() functions must be called first</p>
</div>
</div>
</div>
</body>
</html>